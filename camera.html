<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ultimate Web Camera</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #000;
            font-family: sans-serif;
            touch-action: none;
        }

        #camera-container {
            position: relative;
            width: 100%;
            height: 100%;
            background: #000;
        }

        /* æ˜ åƒè¡¨ç¤ºè¦ç´  */
        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform-origin: center;
            transition: transform 0.1s linear; /* ã‚ºãƒ¼ãƒ ç”¨ */
        }

        /* æ’®å½±çµæœã®è¡¨ç¤ºï¼ˆå†™çœŸãƒ»å‹•ç”»ï¼‰ */
        #review-photo, #review-video {
            display: none;
            width: 100%;
            height: 100%;
            object-fit: contain;
            background: #000;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 15;
        }

        /* UIãƒ¬ã‚¤ãƒ¤ãƒ¼ */
        .ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 20;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        /* æƒ…å ±è¡¨ç¤ºï¼ˆã‚ºãƒ¼ãƒ å€ç‡ãªã©ï¼‰ */
        .info-pill {
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            backdrop-filter: blur(4px);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        #zoom-indicator {
            position: absolute;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
        }

        #camera-name {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            max-width: 80%;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* éŒ²ç”»æ™‚é–“è¡¨ç¤º */
        #rec-timer {
            position: absolute;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            color: red;
            font-weight: bold;
            font-size: 1.2rem;
            display: none;
            text-shadow: 0 0 5px rgba(0,0,0,0.5);
        }
        .blinking { animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0; } }

        /* ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        #errorMsg {
            color: white;
            background: rgba(220, 53, 69, 0.9);
            text-align: center;
            padding: 15px;
            display: none;
            pointer-events: auto;
            position: absolute;
            top: 50%;
            width: 100%;
            transform: translateY(-50%);
            z-index: 30;
        }

        /* ä¸Šéƒ¨ãƒãƒ¼ */
        .top-bar {
            padding: 20px;
            display: flex;
            justify-content: space-between; /* å·¦å³ã«é…ç½® */
            align-items: center;
        }

        /* ä¸‹éƒ¨ãƒãƒ¼ */
        .bottom-bar {
            padding: 20px;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .controls-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            width: 100%;
        }

        /* ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ã‚¹ã‚¤ãƒƒãƒ */
        .mode-switch {
            display: flex;
            gap: 20px;
            margin-bottom: 10px;
            pointer-events: auto;
        }
        .mode-btn {
            color: #aaa;
            font-weight: bold;
            font-size: 0.9rem;
            cursor: pointer;
            padding: 5px 10px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.8);
        }
        .mode-btn.active {
            color: #ffcc00; /* ã‚¢ã‚¯ãƒ†ã‚£ãƒ–è‰²ã¯é»„è‰² */
            border-bottom: 2px solid #ffcc00;
        }

        /* ãƒœã‚¿ãƒ³å…±é€š */
        button {
            pointer-events: auto;
            cursor: pointer;
            border: none;
            outline: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: transform 0.1s;
        }
        button:active { transform: scale(0.92); }

        /* ã‚¢ã‚¤ã‚³ãƒ³ãƒœã‚¿ãƒ³ï¼ˆãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ»åˆ‡æ›¿ï¼‰ */
        .icon-btn {
            background-color: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(5px);
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãŒONã®ã¨ã */
        #flashBtn.active {
            background-color: #ffcc00;
            color: #000;
        }

        /* ã‚·ãƒ£ãƒƒã‚¿ãƒ¼ãƒœã‚¿ãƒ³ */
        #shutterBtn {
            width: 76px;
            height: 76px;
            border-radius: 50%;
            border: 4px solid white;
            background-color: transparent;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* å†™çœŸãƒ¢ãƒ¼ãƒ‰ã®ä¸­èº«ï¼ˆç™½ï¼‰ */
        #shutterBtn.photo-mode::after {
            content: '';
            width: 64px;
            height: 64px;
            background-color: white;
            border-radius: 50%;
            transition: all 0.2s;
        }
        
        /* å‹•ç”»ãƒ¢ãƒ¼ãƒ‰ã®ä¸­èº«ï¼ˆèµ¤ï¼‰ */
        #shutterBtn.video-mode {
            border-color: white;
        }
        #shutterBtn.video-mode::after {
            content: '';
            width: 64px;
            height: 64px;
            background-color: #ff3b30;
            border-radius: 50%;
            transition: all 0.2s;
        }
        
        /* éŒ²ç”»ä¸­ã®å½¢çŠ¶ï¼ˆå››è§’ï¼‰ */
        #shutterBtn.recording::after {
            width: 36px;
            height: 36px;
            border-radius: 6px;
            transform: scale(1);
        }

        /* ä¿å­˜ãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³ */
        .sub-btn {
            background-color: white;
            color: #111;
            padding: 12px 24px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 0.95rem;
            display: none;
        }
        #downloadBtn { background-color: #2ed573; color: white; }

    </style>
</head>
<body>

    <div id="camera-container">
        <!-- ãƒ©ã‚¤ãƒ–æ˜ åƒ -->
        <video id="video" autoplay playsinline muted></video>
        
        <!-- ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ï¼ˆå†™çœŸï¼‰ -->
        <img id="review-photo" alt="review">
        <!-- ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ï¼ˆå‹•ç”»ï¼‰ -->
        <video id="review-video" playsinline controls></video>
        
        <!-- UIãƒ¬ã‚¤ãƒ¤ãƒ¼ -->
        <div class="ui-layer">
            <div id="errorMsg"></div>
            
            <div id="camera-name" class="info-pill">Initializing...</div>
            <div id="zoom-indicator" class="info-pill">1.0x</div>
            <div id="rec-timer" class="blinking">00:00</div>

            <!-- ä¸Šéƒ¨ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ -->
            <div class="top-bar">
                <button id="flashBtn" class="icon-btn">âš¡</button>
                <button id="switchBtn" class="icon-btn">ğŸ”„</button>
            </div>

            <!-- ä¸‹éƒ¨æ“ä½œã‚¨ãƒªã‚¢ -->
            <div class="bottom-bar">
                <!-- ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ -->
                <div class="mode-switch" id="modeSwitchContainer">
                    <span id="modePhoto" class="mode-btn active">å†™çœŸ</span>
                    <span id="modeVideo" class="mode-btn">ãƒ“ãƒ‡ã‚ª</span>
                </div>

                <div class="controls-row">
                    <button id="resetBtn" class="sub-btn">âœ– ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                    <button id="shutterBtn" class="photo-mode"></button>
                    <button id="downloadBtn" class="sub-btn">â¬‡ ä¿å­˜</button>
                </div>
            </div>
        </div>
    </div>

    <!-- å†™çœŸå‡¦ç†ç”¨ã‚­ãƒ£ãƒ³ãƒã‚¹ -->
    <canvas id="canvas" style="display:none;"></canvas>

    <script>
        // --- å¤‰æ•°å®šç¾© ---
        const video = document.getElementById('video');
        const reviewPhoto = document.getElementById('review-photo');
        const reviewVideo = document.getElementById('review-video');
        const canvas = document.getElementById('canvas');
        
        // UIè¦ç´ 
        const errorMsg = document.getElementById('errorMsg');
        const cameraNameDisplay = document.getElementById('camera-name');
        const zoomIndicator = document.getElementById('zoom-indicator');
        const recTimer = document.getElementById('rec-timer');
        const modeSwitchContainer = document.getElementById('modeSwitchContainer');
        
        // ãƒœã‚¿ãƒ³
        const shutterBtn = document.getElementById('shutterBtn');
        const switchBtn = document.getElementById('switchBtn');
        const flashBtn = document.getElementById('flashBtn');
        const resetBtn = document.getElementById('resetBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const modePhotoBtn = document.getElementById('modePhoto');
        const modeVideoBtn = document.getElementById('modeVideo');

        // çŠ¶æ…‹ç®¡ç†
        let videoDevices = [];
        let currentDeviceIndex = 0;
        let currentStream = null;
        let isFrontCamera = false;
        let isFlashOn = false;
        
        // ãƒ¢ãƒ¼ãƒ‰ç®¡ç†: 'photo' | 'video'
        let currentMode = 'photo';
        let isRecording = false;
        let mediaRecorder = null;
        let recordedChunks = [];
        let recordingStartTime = 0;
        let recordingTimerInterval = null;
        let recordedBlobUrl = null;

        // ã‚ºãƒ¼ãƒ ç®¡ç†
        let currentZoom = 1.0;
        const minZoom = 1.0;
        const maxZoom = 5.0;
        let initialPinchDistance = 0;
        let startZoomLevel = 1.0;

        // --- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ---
        let fadeTimer = null;
        function showInfo(element, text) {
            element.textContent = text;
            element.style.opacity = '1';
            clearTimeout(fadeTimer);
            setTimeout(() => { element.style.opacity = '0'; }, 2000);
        }

        // --- ã‚«ãƒ¡ãƒ©èµ·å‹•ãƒ»åˆ‡æ›¿ ---
        async function getCameraDevices() {
            try {
                // æ¨©é™ãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨ãƒ€ãƒŸãƒ¼ã‚¹ãƒˆãƒªãƒ¼ãƒ 
                const temp = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
                temp.getTracks().forEach(t => t.stop());
                
                const devices = await navigator.mediaDevices.enumerateDevices();
                videoDevices = devices.filter(d => d.kind === 'videoinput');
                
                if(videoDevices.length === 0) throw new Error("ã‚«ãƒ¡ãƒ©ãªã—");
            } catch(e) {
                console.warn(e);
            }
        }

        async function startCamera(index) {
            if (currentStream) {
                currentStream.getTracks().forEach(track => track.stop());
            }
            if (index >= videoDevices.length) index = 0;
            currentDeviceIndex = index;

            const device = videoDevices[index];
            currentZoom = 1.0;
            isFlashOn = false;
            flashBtn.classList.remove('active');

            // 4Kè¦æ±‚
            const constraints = {
                video: {
                    deviceId: { exact: device.deviceId },
                    width: { ideal: 3840 },
                    height: { ideal: 2160 },
                    frameRate: { ideal: 30 }
                },
                audio: true // å‹•ç”»ç”¨
            };

            try {
                const stream = await navigator.mediaDevices.getUserMedia(constraints);
                currentStream = stream;
                video.srcObject = stream;
                video.muted = true; // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯ãƒŸãƒ¥ãƒ¼ãƒˆ
                errorMsg.style.display = 'none';

                // ã‚«ãƒ¡ãƒ©æƒ…å ±åˆ¤å®š
                const track = stream.getVideoTracks()[0];
                const settings = track.getSettings();
                const label = device.label.toLowerCase();
                isFrontCamera = (settings.facingMode === 'user') || label.includes('front') || label.includes('å‰');
                
                showInfo(cameraNameDisplay, device.label || `Camera ${index + 1}`);
                updateVideoTransform();

                // ãƒ•ãƒ©ãƒƒã‚·ãƒ¥å¯¾å¿œç¢ºèª
                const capabilities = track.getCapabilities ? track.getCapabilities() : {};
                if (capabilities.torch) {
                    flashBtn.style.opacity = '1';
                    flashBtn.disabled = false;
                } else {
                    flashBtn.style.opacity = '0.3';
                    flashBtn.disabled = true;
                }

            } catch (err) {
                console.error(err);
                errorMsg.textContent = "ã‚«ãƒ¡ãƒ©èµ·å‹•ã‚¨ãƒ©ãƒ¼ã€‚httpsæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚";
                errorMsg.style.display = 'block';
            }
        }

        // --- ã‚ºãƒ¼ãƒ å‡¦ç† ---
        function updateVideoTransform() {
            const scaleX = isFrontCamera ? -1 : 1;
            
            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã®ã‚ºãƒ¼ãƒ ï¼ˆCSSï¼‰
            video.style.transform = `scale(${currentZoom * scaleX}, ${currentZoom})`;
            
            // å¯èƒ½ãªå ´åˆã¯ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚ºãƒ¼ãƒ ã‚‚é©ç”¨ï¼ˆå‹•ç”»æ’®å½±ç”¨ï¼‰
            const track = currentStream.getVideoTracks()[0];
            const caps = track.getCapabilities ? track.getCapabilities() : {};
            
            if (caps.zoom) {
                // ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚ºãƒ¼ãƒ ãŒåŠ¹ãç¯„å›²ã§é©ç”¨
                track.applyConstraints({
                    advanced: [{ zoom: Math.min(Math.max(currentZoom, caps.zoom.min), caps.zoom.max) }]
                }).catch(e => console.log('HW Zoom failed', e));
            }

            zoomIndicator.textContent = `${currentZoom.toFixed(1)}x`;
            zoomIndicator.style.opacity = '1';
            clearTimeout(window.zoomTimer);
            window.zoomTimer = setTimeout(() => { zoomIndicator.style.opacity = '0'; }, 1000);
        }

        document.getElementById('camera-container').addEventListener('touchstart', (e) => {
            if (e.touches.length === 2) {
                initialPinchDistance = getMathDistance(e.touches);
                startZoomLevel = currentZoom;
                e.preventDefault();
            }
        }, { passive: false });

        document.getElementById('camera-container').addEventListener('touchmove', (e) => {
            if (e.touches.length === 2 && initialPinchDistance > 0) {
                const dist = getMathDistance(e.touches);
                const zoomChange = dist / initialPinchDistance;
                currentZoom = Math.max(minZoom, Math.min(startZoomLevel * zoomChange, maxZoom));
                updateVideoTransform();
                e.preventDefault();
            }
        }, { passive: false });

        function getMathDistance(touches) {
            const dx = touches[0].clientX - touches[1].clientX;
            const dy = touches[0].clientY - touches[1].clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }

        // --- ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ï¼ˆãƒˆãƒ¼ãƒï¼‰ ---
        flashBtn.addEventListener('click', async () => {
            if (!currentStream) return;
            const track = currentStream.getVideoTracks()[0];
            const caps = track.getCapabilities();

            if (!caps.torch) {
                alert("ã“ã®ç«¯æœ«/ãƒ–ãƒ©ã‚¦ã‚¶ã¯ãƒ©ã‚¤ãƒˆæ“ä½œã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“(iOS Safariãªã©)");
                return;
            }

            try {
                isFlashOn = !isFlashOn;
                await track.applyConstraints({
                    advanced: [{ torch: isFlashOn }]
                });
                flashBtn.classList.toggle('active', isFlashOn);
            } catch (err) {
                console.error(err);
                alert("ãƒ©ã‚¤ãƒˆã®åˆ‡ã‚Šæ›¿ãˆã«å¤±æ•—ã—ã¾ã—ãŸ");
            }
        });

        // --- ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ ---
        function setMode(mode) {
            currentMode = mode;
            if (mode === 'photo') {
                modePhotoBtn.classList.add('active');
                modeVideoBtn.classList.remove('active');
                shutterBtn.className = 'photo-mode';
            } else {
                modePhotoBtn.classList.remove('active');
                modeVideoBtn.classList.add('active');
                shutterBtn.className = 'video-mode';
            }
        }
        modePhotoBtn.addEventListener('click', () => setMode('photo'));
        modeVideoBtn.addEventListener('click', () => setMode('video'));

        // --- æ’®å½±ãƒ»éŒ²ç”» ---
        shutterBtn.addEventListener('click', () => {
            if (currentMode === 'photo') {
                takePhoto();
            } else {
                if (isRecording) {
                    stopRecording();
                } else {
                    startRecording();
                }
            }
        });

        // å†™çœŸæ’®å½±
        function takePhoto() {
            const vw = video.videoWidth;
            const vh = video.videoHeight;
            canvas.width = vw;
            canvas.height = vh;
            const ctx = canvas.getContext('2d');

            // ã‚ºãƒ¼ãƒ åˆ‡ã‚Šå‡ºã—è¨ˆç®—
            const sWidth = vw / currentZoom;
            const sHeight = vh / currentZoom;
            const sx = (vw - sWidth) / 2;
            const sy = (vh - sHeight) / 2;

            ctx.save();
            if (isFrontCamera) {
                ctx.translate(canvas.width, 0);
                ctx.scale(-1, 1);
            }
            ctx.drawImage(video, sx, sy, sWidth, sHeight, 0, 0, canvas.width, canvas.height);
            ctx.restore();

            reviewPhoto.src = canvas.toDataURL('image/png', 1.0);
            showReviewState(true);
        }

        // å‹•ç”»éŒ²ç”»é–‹å§‹
        function startRecording() {
            recordedChunks = [];
            
            // MIMEã‚¿ã‚¤ãƒ—ã®æ±ºå®šï¼ˆãƒ–ãƒ©ã‚¦ã‚¶äº’æ›æ€§ï¼‰
            let mimeType = 'video/webm;codecs=vp9';
            if (!MediaRecorder.isTypeSupported(mimeType)) {
                mimeType = 'video/webm'; // Chrome Default
                if (!MediaRecorder.isTypeSupported(mimeType)) {
                    mimeType = 'video/mp4'; // Safari Default
                }
            }

            try {
                mediaRecorder = new MediaRecorder(currentStream, { mimeType: mimeType });
            } catch (e) {
                alert("éŒ²ç”»ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æœªå¯¾å¿œã®å½¢å¼ã§ã™ã€‚");
                return;
            }

            mediaRecorder.ondataavailable = (event) => {
                if (event.data.size > 0) recordedChunks.push(event.data);
            };

            mediaRecorder.onstop = () => {
                const blob = new Blob(recordedChunks, { type: mimeType });
                recordedBlobUrl = URL.createObjectURL(blob);
                reviewVideo.src = recordedBlobUrl;
                showReviewState(false); // å‹•ç”»ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã¸
            };

            mediaRecorder.start();
            isRecording = true;
            shutterBtn.classList.add('recording');
            
            // ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹
            recordingStartTime = Date.now();
            recTimer.style.display = 'block';
            updateTimer();
            recordingTimerInterval = setInterval(updateTimer, 1000);
            
            // UIéš ã—
            modeSwitchContainer.style.display = 'none';
            switchBtn.style.display = 'none';
        }

        // å‹•ç”»éŒ²ç”»åœæ­¢
        function stopRecording() {
            mediaRecorder.stop();
            isRecording = false;
            shutterBtn.classList.remove('recording');
            
            clearInterval(recordingTimerInterval);
            recTimer.style.display = 'none';
        }

        function updateTimer() {
            const diff = Math.floor((Date.now() - recordingStartTime) / 1000);
            const m = Math.floor(diff / 60).toString().padStart(2, '0');
            const s = (diff % 60).toString().padStart(2, '0');
            recTimer.textContent = `${m}:${s}`;
        }

        // --- ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ç®¡ç† ---
        function showReviewState(isPhoto) {
            video.style.display = 'none';
            if (isPhoto) {
                reviewPhoto.style.display = 'block';
                reviewVideo.style.display = 'none';
            } else {
                reviewPhoto.style.display = 'none';
                reviewVideo.style.display = 'block';
            }

            shutterBtn.style.display = 'none';
            switchBtn.style.display = 'none';
            flashBtn.style.display = 'none';
            modeSwitchContainer.style.display = 'none';
            
            resetBtn.style.display = 'block';
            downloadBtn.style.display = 'block';
        }

        // ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼ˆãƒªã‚»ãƒƒãƒˆï¼‰
        resetBtn.addEventListener('click', () => {
            reviewPhoto.style.display = 'none';
            reviewVideo.style.display = 'none';
            reviewVideo.pause();
            if(recordedBlobUrl) URL.revokeObjectURL(recordedBlobUrl);
            
            video.style.display = 'block';
            shutterBtn.style.display = 'flex';
            switchBtn.style.display = 'flex';
            flashBtn.style.display = 'flex';
            modeSwitchContainer.style.display = 'flex';
            
            resetBtn.style.display = 'none';
            downloadBtn.style.display = 'none';
        });

        // ä¿å­˜å‡¦ç†
        downloadBtn.addEventListener('click', () => {
            const link = document.createElement('a');
            const now = new Date();
            const dateStr = `${now.getFullYear()}${now.getMonth()+1}${now.getDate()}_${now.getHours()}${now.getMinutes()}${now.getSeconds()}`;
            
            if (currentMode === 'photo') {
                link.download = `IMG_${dateStr}.png`;
                link.href = reviewPhoto.src;
            } else {
                // å‹•ç”»ã®æ‹¡å¼µå­åˆ¤å®š
                const type = mediaRecorder.mimeType;
                const ext = type.includes('mp4') ? 'mp4' : 'webm';
                link.download = `VID_${dateStr}.${ext}`;
                link.href = reviewVideo.src;
            }
            link.click();
        });

        // ã‚«ãƒ¡ãƒ©åˆ‡æ›¿
        switchBtn.addEventListener('click', () => {
            startCamera(currentDeviceIndex + 1);
        });

        // åˆæœŸåŒ–
        (async function init() {
            await getCameraDevices();
            startCamera(0);
        })();

    </script>
</body>
</html>
